<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Registration Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="/webjars/jquery/3.6.4/jquery.min.js"></script>
  </head>
  <body>
	  <div class="container">
    <h2 class="mt-5">Register Here</h2>
   <font style="color:green;"> <p th:text="${succMsg}"> </p> </font>
   <font style="color:red;"> <p th:text="${errMsg}"> </p> </font>
   
    <form th:action="@{/register}" th:object="${register}" method="post">
		<table>
			<tr>
				<td>Name :</td>
				<td> <input type="text" th:field="*{uname}" required> </td>
			</tr>
			<tr>
				<td>Email :</td>
				<td> <input type="email" th:field="*{email}" required> </td>
			</tr>
			<tr>
				<td>Country :</td>
				<td>
					<select th:field="*{countryId}" id="countryId" class="form-select" required>
						<option value=""> -select- </option>
						<option th:each="entry :${countries.entrySet()}" th:value="${entry.key}" th:text="${entry.value}"> </option>		
					</select>
				</td>
			</tr>
			<tr>
				<td>State :</td>
				<td>
					<select th:field="*{stateId}" id="stateId" class="form-select" required>
						<option value="">-select-</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>City :</td>
				<td>
					<select th:field="*{cityId}" id="cityId" class="form-select" required>
						<option value="">-select-</option>
					</select>
				</td>
			</tr>
			<tr>
				<td> </td>
				<td> <input type="submit" value="Sign-In" class="btn btn-primary"> </td>
			</tr>
			
		</table>
	</form>
	&nbsp;
	Already have an account ? <a href="/">Sign-in Here</a>
    </div>
    
    <script>
		
    $(document).ready(function() {
		
		$('#countryId').on("change",function(){
			$('#stateId').find("option").remove();
			$('#cityId').find("option").remove();
			$.ajax({
				type:'GET',
				url:'/states?countryId='+$('#countryId').val(),
				success:function(result){
					console.log(result);
					$.each(result,function(key,value){
						$('<option>').val(key).text(value).appendTo('#stateId');
						
					});
				}
			});
		});
	});
		
		
		$(document).ready(function(){
		$('#stateId').on("change",function(){
			$('#cityId').find("option").remove();
			$.ajax({
				type:'GET',
				url:'/cities?stateId='+$('#stateId').val(),
				success:function(result){
					console.log(result);
					$.each(result,function(key,value){
						$('<option>').val(key).text(value).appendTo('#cityId');
						
					});
				}
			});
		});
	});
	</script>
	
	
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  </body>
</html>
